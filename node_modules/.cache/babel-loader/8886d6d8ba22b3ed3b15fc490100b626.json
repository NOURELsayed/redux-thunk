{"ast":null,"code":"var _jsxFileName = \"/media/norhan/New Volume/work/React-projects/test-redux/src/containers/OrdersPage/OrderItemAsBuyer.jsx\";\nimport React, { Component, Fragment } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Grid, Card, Label, Button, Image, Segment, Form, Divider } from \"semantic-ui-react\";\nimport { Link } from \"react-router-dom\";\nimport { orderConstants, returnRequestsConstants } from \"../../constants\";\nimport { imageUrl } from \"../../config\";\nimport { returnRequestsActions } from \"../../actions\";\nimport { orderActions } from \"../../actions\";\nimport { validatorActions } from \"../../actions\";\nconst frontendUrl = \"http://localhost:5000\"; // TODO: NEED TO RETRIEVE IT FROM CONFIG FILE\n\nclass OrderItemAsBuyer extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangeNotes = (e, {\n      name,\n      value\n    }) => {\n      this.props.validateInput(this.schemaBuyerInvestigationNotes, name, value);\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.handleBuyerInvestigationDecision = async (returnRequest, decision) => {\n      const body = {\n        buyerNotes: this.state.buyerInvestigationNotes\n      };\n\n      if (decision === \"request\" && returnRequest) {\n        await this.props.investigationDecision(\"request\", returnRequest._id, body);\n      } else if (decision === \"ignore\" && returnRequest) {\n        await this.props.investigationDecision(\"ignore\", returnRequest._id, {\n          buyerNotes: \"\"\n        });\n      }\n    };\n\n    this.schemaBuyerInvestigationNotes = {\n      required: [\"buyerInvestigationNotes\"],\n      properties: {\n        buyerInvestigationNotes: {\n          title: \"buyerInvestigationNotes\",\n          type: \"string\",\n          minLength: 1,\n          maxLength: 500\n        }\n      }\n    };\n\n    this.getReturnNote = () => {\n      const now = new Date();\n      const returnWindow = new Date(this.props.returnWindow);\n\n      if (now < returnWindow) {\n        return \"Return window will close at : \" + this.props.combinedDate;\n      }\n\n      return \"Return window closed at : \" + this.props.combinedDate;\n    };\n\n    this.arrivedAtSPBtnClicked = () => {\n      this.props.arrivedAtSPBtnClicked(this.props.orderData._id);\n    };\n\n    this.returnItemClicked = () => {\n      this.props.returnItemClicked(this.props.orderData._id);\n    };\n\n    this.state = {\n      returnWindowOpen: false,\n      requestWasNotSent: true,\n      buyerInvestigationNotes: \"\"\n    };\n  }\n\n  async componentDidMount() {\n    const now = new Date();\n    const returnWindow = new Date(this.props.returnWindow);\n\n    if (now < returnWindow) {\n      this.setState({\n        returnWindowOpen: true\n      });\n    }\n  }\n\n  render() {\n    const {\n      orderData,\n      itemData,\n      orderStatus,\n      returnRequest\n    } = this.props;\n    const {\n      buyerInvestigationNotes\n    } = this.state;\n    const reviewSeller = orderData.reviews.filter(review => review.revieweeType === \"seller\");\n    const canReview = orderStatus === orderConstants.ORDER_STATUS_ORDER_PICKED_UP || orderStatus === orderConstants.ORDER_STATUS_REJECTED_SOME_BY_BUYER;\n    let image = \"\";\n\n    if (itemData.post) {\n      image = itemData.post.images[0];\n    }\n\n    return /*#__PURE__*/React.createElement(Grid, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Column, {\n      width: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Card.Content, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Image, {\n      floated: \"left\",\n      size: \"tiny\",\n      src: `${imageUrl}/${image}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Card.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: `/post/${itemData.post._id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 19\n      }\n    }, itemData.post.title)), /*#__PURE__*/React.createElement(Card.Description, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 19\n      }\n    }, \"Seller : \"), /*#__PURE__*/React.createElement(Link, {\n      to: `/user/${orderData.sellerData.seller._id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 19\n      }\n    }, orderData.sellerData.seller.username)), /*#__PURE__*/React.createElement(Card.Description, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 19\n      }\n    }, \"Condition : \"), \" \", itemData.post.condition), /*#__PURE__*/React.createElement(Card.Description, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 19\n      }\n    }, \"Status : \"), \" \", itemData.status)))), /*#__PURE__*/React.createElement(Grid.Column, {\n      width: 10,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Column, {\n      width: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      disabled: orderStatus !== orderConstants.ORDER_STATUS_ALL_ITEMS_AT_SP,\n      onClick: this.arrivedAtSPBtnClicked,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 19\n      }\n    }, \"Arrived At SP\"))), /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Column, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }\n    }, reviewSeller.length === 1 && /*#__PURE__*/React.createElement(Button, {\n      as: Link,\n      disabled: !canReview,\n      to: {\n        pathname: `/review/details`,\n        review: reviewSeller[0]\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 21\n      }\n    }, \"View Review\"), itemData.status !== orderConstants.ITEM_STATUS_REJECTED_BY_BUYER && /*#__PURE__*/React.createElement(Button, {\n      disabled: (orderStatus === orderConstants.ORDER_STATUS_ORDER_PICKED_UP || orderStatus === orderConstants.ORDER_STATUS_REJECTED_SOME_BY_BUYER) && this.state.returnWindowOpen && this.state.requestWasNotSent && !returnRequest ? false : true,\n      onClick: this.returnItemClicked,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }\n    }, \"Return Item\"))), itemData.status !== orderConstants.ITEM_STATUS_REJECTED_BY_BUYER && (orderStatus === orderConstants.ORDER_STATUS_ORDER_PICKED_UP || orderStatus === orderConstants.ORDER_STATUS_REJECTED_SOME_BY_BUYER) ? /*#__PURE__*/React.createElement(Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 21\n      }\n    }, this.getReturnNote(this.props.returnWindow), \" \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 69\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 23\n      }\n    }), returnRequest ? \"Return Request Sent to Seller\" : \"\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 23\n      }\n    }), returnRequest && returnRequest.sellerData.decision !== undefined && returnRequest.sellerData.decision === \"accept\" ? \"Seller accpeted the return request \" : returnRequest && returnRequest.sellerData.decision !== undefined && returnRequest.sellerData.decision === \"reject\" ? \"Seller rejected the return request \" : \"\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 23\n      }\n    }), returnRequest && returnRequest.sellerData.decision !== undefined && returnRequest.sellerData.decision === \"reject\" && returnRequest.investigation.status === \"InProgress\" ? \"An Investigation has been opened\" : returnRequest && returnRequest.sellerData.decision !== undefined && returnRequest.sellerData.decision === \"reject\" && returnRequest.investigation.status === \"Finished\" ? \"Investigation Concluded\" : \"\")), /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 19\n      }\n    }, returnRequest && returnRequest.sellerData.decision !== undefined && returnRequest.sellerData.decision === \"reject\" && returnRequest.investigation.status === \"New\" ? /*#__PURE__*/React.createElement(Segment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 23\n      }\n    }, \"Would you like to open an \", /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 51\n      }\n    }, \"Investigation\"), \"? \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 27\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      color: \"green\",\n      onClick: e => {\n        this.handleBuyerInvestigationDecision(returnRequest, \"request\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 25\n      }\n    }, \"Yes\"), /*#__PURE__*/React.createElement(Button, {\n      color: \"red\",\n      onClick: e => {\n        this.handleBuyerInvestigationDecision(returnRequest, \"ignore\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 25\n      }\n    }, \"No\"), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Label, {\n      style: {\n        marginTop: \"5%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 25\n      }\n    }, \"Investigation Notes\"), /*#__PURE__*/React.createElement(Form, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Form.TextArea, {\n      name: \"buyerInvestigationNotes\",\n      type: \"string\",\n      placeholder: \"Notes ...\",\n      onChange: this.handleChangeNotes,\n      value: buyerInvestigationNotes,\n      error: this.props.validation.errors && this.props.validation.errors.buyerInvestigationNotes,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 27\n      }\n    }))) : \"\")) : /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 17\n      }\n    })))));\n  }\n\n}\n\nfunction mapState(state) {\n  return { ...state\n  };\n}\n\nconst actionCreators = {\n  arrivedAtSPBtnClicked: orderActions.arrivedAtSPBtnClicked,\n  returnItemClicked: orderActions.returnOrderBtnClicked,\n  investigationDecision: returnRequestsActions.openInvestigation,\n  validateInput: validatorActions.validateInput,\n  validateForm: validatorActions.validateForm\n};\nconst connectedOrderItemAsBuyer = connect(mapState, actionCreators)(OrderItemAsBuyer);\nexport { connectedOrderItemAsBuyer as OrderItemAsBuyer };","map":{"version":3,"sources":["/media/norhan/New Volume/work/React-projects/test-redux/src/containers/OrdersPage/OrderItemAsBuyer.jsx"],"names":["React","Component","Fragment","connect","Grid","Card","Label","Button","Image","Segment","Form","Divider","Link","orderConstants","returnRequestsConstants","imageUrl","returnRequestsActions","orderActions","validatorActions","frontendUrl","OrderItemAsBuyer","constructor","props","handleChangeNotes","e","name","value","validateInput","schemaBuyerInvestigationNotes","setState","handleBuyerInvestigationDecision","returnRequest","decision","body","buyerNotes","state","buyerInvestigationNotes","investigationDecision","_id","required","properties","title","type","minLength","maxLength","getReturnNote","now","Date","returnWindow","combinedDate","arrivedAtSPBtnClicked","orderData","returnItemClicked","returnWindowOpen","requestWasNotSent","componentDidMount","render","itemData","orderStatus","reviewSeller","reviews","filter","review","revieweeType","canReview","ORDER_STATUS_ORDER_PICKED_UP","ORDER_STATUS_REJECTED_SOME_BY_BUYER","image","post","images","sellerData","seller","username","condition","status","ORDER_STATUS_ALL_ITEMS_AT_SP","length","pathname","ITEM_STATUS_REJECTED_BY_BUYER","undefined","investigation","marginTop","validation","errors","mapState","actionCreators","returnOrderBtnClicked","openInvestigation","validateForm","connectedOrderItemAsBuyer"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Grid,\r\n  Card,\r\n  Label,\r\n  Button,\r\n  Image,\r\n  Segment,\r\n  Form,\r\n  Divider,\r\n} from \"semantic-ui-react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { orderConstants, returnRequestsConstants } from \"../../constants\";\r\nimport { imageUrl } from \"../../config\";\r\nimport { returnRequestsActions } from \"../../actions\";\r\nimport { orderActions } from \"../../actions\";\r\nimport { validatorActions } from \"../../actions\";\r\n\r\nconst frontendUrl = \"http://localhost:5000\"; // TODO: NEED TO RETRIEVE IT FROM CONFIG FILE\r\n\r\nclass OrderItemAsBuyer extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      returnWindowOpen: false,\r\n      requestWasNotSent: true,\r\n      buyerInvestigationNotes: \"\",\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const now = new Date();\r\n    const returnWindow = new Date(this.props.returnWindow);\r\n\r\n    if (now < returnWindow) {\r\n      this.setState({ returnWindowOpen: true });\r\n    }\r\n  }\r\n\r\n  handleChangeNotes = (e, { name, value }) => {\r\n    this.props.validateInput(this.schemaBuyerInvestigationNotes, name, value);\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  handleBuyerInvestigationDecision = async (returnRequest, decision) => {\r\n    const body = { buyerNotes: this.state.buyerInvestigationNotes };\r\n\r\n    if (decision === \"request\" && returnRequest) {\r\n      await this.props.investigationDecision(\r\n        \"request\",\r\n        returnRequest._id,\r\n        body\r\n      );\r\n    } else if (decision === \"ignore\" && returnRequest) {\r\n      await this.props.investigationDecision(\"ignore\", returnRequest._id, {buyerNotes:\"\"});\r\n    }\r\n  };\r\n\r\n  schemaBuyerInvestigationNotes = {\r\n    required: [\"buyerInvestigationNotes\"],\r\n    properties: {\r\n      buyerInvestigationNotes: {\r\n        title: \"buyerInvestigationNotes\",\r\n        type: \"string\",\r\n        minLength: 1,\r\n        maxLength: 500,\r\n      },\r\n    },\r\n  };\r\n\r\n  getReturnNote = () => {\r\n    const now = new Date();\r\n\r\n    const returnWindow = new Date(this.props.returnWindow);\r\n\r\n    if (now < returnWindow) {\r\n      return \"Return window will close at : \" + this.props.combinedDate;\r\n    }\r\n    return \"Return window closed at : \" + this.props.combinedDate;\r\n  };\r\n\r\n  arrivedAtSPBtnClicked = () => {\r\n    this.props.arrivedAtSPBtnClicked(this.props.orderData._id);\r\n  };\r\n\r\n  returnItemClicked = () => {\r\n    this.props.returnItemClicked(this.props.orderData._id);\r\n  };\r\n\r\n  render() {\r\n    const { orderData, itemData, orderStatus, returnRequest } = this.props;\r\n\r\n    const { buyerInvestigationNotes } = this.state;\r\n    const reviewSeller = orderData.reviews.filter(\r\n      (review) => review.revieweeType === \"seller\"\r\n    );\r\n    const canReview =\r\n      orderStatus === orderConstants.ORDER_STATUS_ORDER_PICKED_UP ||\r\n      orderStatus === orderConstants.ORDER_STATUS_REJECTED_SOME_BY_BUYER;\r\n\r\n    let image = \"\";\r\n    if (itemData.post) {\r\n      image = itemData.post.images[0];\r\n    }\r\n    return (\r\n      <Grid>\r\n        <Grid.Row>\r\n          <Grid.Column width={6}>\r\n            <Card>\r\n              <Card.Content>\r\n                <Image\r\n                  floated='left'\r\n                  size='tiny'\r\n                  src={`${imageUrl}/${image}`}\r\n                />\r\n                <Card.Header>\r\n                  <a href={`/post/${itemData.post._id}`}>\r\n                    {itemData.post.title}\r\n                  </a>\r\n                </Card.Header>\r\n                <Card.Description>\r\n                  <strong>Seller : </strong>\r\n                  <Link to={`/user/${orderData.sellerData.seller._id}`}>\r\n                    {orderData.sellerData.seller.username}\r\n                  </Link>\r\n                </Card.Description>\r\n                <Card.Description>\r\n                  <strong>Condition : </strong> {itemData.post.condition}\r\n                </Card.Description>\r\n                <Card.Description>\r\n                  <strong>Status : </strong> {itemData.status}\r\n                </Card.Description>\r\n              </Card.Content>\r\n            </Card>\r\n          </Grid.Column>\r\n          <Grid.Column width={10}>\r\n            <Grid>\r\n              <Grid.Row>\r\n                <Grid.Column width={4}>\r\n                  <Button\r\n                    disabled={\r\n                      orderStatus !==\r\n                      orderConstants.ORDER_STATUS_ALL_ITEMS_AT_SP\r\n                    }\r\n                    onClick={this.arrivedAtSPBtnClicked}\r\n                  >\r\n                    Arrived At SP\r\n                  </Button>\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column>\r\n                  {reviewSeller.length === 1 && (\r\n                    <Button\r\n                      as={Link}\r\n                      disabled={!canReview}\r\n                      to={{\r\n                        pathname: `/review/details`,\r\n                        review: reviewSeller[0],\r\n                      }}\r\n                    >\r\n                      View Review\r\n                    </Button>\r\n                  )}\r\n                  {itemData.status !==\r\n                    orderConstants.ITEM_STATUS_REJECTED_BY_BUYER && (\r\n                    <Button\r\n                      disabled={\r\n                        (orderStatus ===\r\n                          orderConstants.ORDER_STATUS_ORDER_PICKED_UP ||\r\n                          orderStatus ===\r\n                            orderConstants.ORDER_STATUS_REJECTED_SOME_BY_BUYER) &&\r\n                        this.state.returnWindowOpen &&\r\n                        this.state.requestWasNotSent &&\r\n                        !returnRequest\r\n                          ? false\r\n                          : true\r\n                      }\r\n                      onClick={this.returnItemClicked}\r\n                    >\r\n                      Return Item\r\n                    </Button>\r\n                  )}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              {itemData.status !==\r\n                orderConstants.ITEM_STATUS_REJECTED_BY_BUYER &&\r\n              (orderStatus === orderConstants.ORDER_STATUS_ORDER_PICKED_UP ||\r\n                orderStatus ===\r\n                  orderConstants.ORDER_STATUS_REJECTED_SOME_BY_BUYER) ? (\r\n                <Fragment>\r\n                  <Grid.Row>\r\n                    <Label>\r\n                      {this.getReturnNote(this.props.returnWindow)} <br />\r\n                      <br />\r\n                      {returnRequest ? \"Return Request Sent to Seller\" : \"\"}\r\n                      <br />\r\n                      <br />\r\n                      {returnRequest &&\r\n                      returnRequest.sellerData.decision !== undefined &&\r\n                      returnRequest.sellerData.decision === \"accept\"\r\n                        ? \"Seller accpeted the return request \"\r\n                        : returnRequest &&\r\n                          returnRequest.sellerData.decision !== undefined &&\r\n                          returnRequest.sellerData.decision === \"reject\"\r\n                        ? \"Seller rejected the return request \"\r\n                        : \"\"}\r\n                      <br />\r\n                      <br />\r\n                      {returnRequest &&\r\n                      returnRequest.sellerData.decision !== undefined &&\r\n                      returnRequest.sellerData.decision === \"reject\" &&\r\n                      returnRequest.investigation.status === \"InProgress\"\r\n                        ? \"An Investigation has been opened\"\r\n                        : returnRequest &&\r\n                          returnRequest.sellerData.decision !== undefined &&\r\n                          returnRequest.sellerData.decision === \"reject\" &&\r\n                          returnRequest.investigation.status === \"Finished\"\r\n                        ? \"Investigation Concluded\"\r\n                        : \"\"}\r\n                    </Label>\r\n                  </Grid.Row>\r\n                  <Grid.Row>\r\n                    {returnRequest &&\r\n                    returnRequest.sellerData.decision !== undefined &&\r\n                    returnRequest.sellerData.decision === \"reject\" &&\r\n                    returnRequest.investigation.status === \"New\" ? (\r\n                      <Segment>\r\n                        Would you like to open an <strong>Investigation</strong>\r\n                        ? <br />\r\n                        <br />\r\n                        <Button\r\n                          color='green'\r\n                          onClick={(e) => {\r\n                            this.handleBuyerInvestigationDecision(returnRequest,\"request\")\r\n                          }}\r\n                        >\r\n                          Yes\r\n                        </Button>\r\n                        <Button\r\n                          color='red'\r\n                          onClick={(e) => {\r\n                           this.handleBuyerInvestigationDecision(returnRequest,\"ignore\")\r\n                          }}\r\n                        >\r\n                          No\r\n                        </Button>\r\n                        <Divider />\r\n                        <Label style={{ marginTop: \"5%\" }}>\r\n                          Investigation Notes\r\n                        </Label>\r\n                        <Form>\r\n                          <Form.TextArea\r\n                            name='buyerInvestigationNotes'\r\n                            type='string'\r\n                            placeholder='Notes ...'\r\n                            onChange={this.handleChangeNotes}\r\n                            value={buyerInvestigationNotes}\r\n                            error={\r\n                              this.props.validation.errors &&\r\n                              this.props.validation.errors\r\n                                .buyerInvestigationNotes\r\n                            }\r\n                          />\r\n                        </Form>\r\n                      </Segment>\r\n                    ) : (\r\n                      \"\"\r\n                    )}\r\n                  </Grid.Row>\r\n                </Fragment>\r\n              ) : (\r\n                <Grid.Row></Grid.Row>\r\n              )}\r\n            </Grid>\r\n          </Grid.Column>\r\n        </Grid.Row>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nfunction mapState(state) {\r\n  return { ...state };\r\n}\r\n\r\nconst actionCreators = {\r\n  arrivedAtSPBtnClicked: orderActions.arrivedAtSPBtnClicked,\r\n  returnItemClicked: orderActions.returnOrderBtnClicked,\r\n  investigationDecision: returnRequestsActions.openInvestigation,\r\n  validateInput: validatorActions.validateInput,\r\n  validateForm: validatorActions.validateForm,\r\n};\r\n\r\nconst connectedOrderItemAsBuyer = connect(\r\n  mapState,\r\n  actionCreators\r\n)(OrderItemAsBuyer);\r\n\r\nexport { connectedOrderItemAsBuyer as OrderItemAsBuyer };\r\n"]},"metadata":{},"sourceType":"module"}